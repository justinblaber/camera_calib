function test_p_w2p_p_d
    p_w = [0     0;
           0    50;
           0   100;
           0   150];

    H = 1.0e+05 * [0.001281293950729   0.006224651910317   0.726434534955307;
                  -0.004328900760247   0.000626577736316   4.895698496749930;
                   0.000004151542188   0.000001339607712   0.010382847476685];

    % Distort
    a = 1.0e+02 * [5.811989327265433;
                   3.115861087870574;
                   2.342314804973926];
    d = [ 0.072064394856535;
         -0.202044348085313;
         -0.025155451778392;
          0.009925044485141];
    p_p_d = alg.p_w2p_p_d(p_w, ...
                          @(p, H)alg.apply_homography_p2p(p, H), ...
                          H, ...
                          @(x_p, y_p, a, x_o, y_o, k1, k2, p, t)[x_o-((x_o-x_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./((p.*(x_o-x_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a-(t.*(y_o-y_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a+1.0), y_o-((y_o-y_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./((p.*(x_o-x_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a-(t.*(y_o-y_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a+1.0)], ...
                          a, ...
                          d);

    % Assert
    assert(all(all(abs(p_p_d - 1.0e+02 * [0.681190116616448   4.733306445785082;
                                          0.974677152615650   4.735414151049203;
                                          1.266469580960996   4.735588116500557;
                                          1.555559011987710   4.734394249636511]) < 1e-4)));
end
