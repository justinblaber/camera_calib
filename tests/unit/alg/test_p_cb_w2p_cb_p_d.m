function test_p_cb_w2p_cb_p_d
    p_cb_ws = [0     0;
               0    50;
               0   100;
               0   150];

    R = [-0.008414387150832   0.989622421405270  -0.143445673133928;
         -0.909712137256249   0.051980523517852   0.411973121093449;
          0.415154218836258   0.133960771223444   0.899834143804110];

    t = 1.0e+03 * [-0.444199579715235;
                    0.409595472908999;
                    1.038284747668525];

    % Distort
    a = 1.0e+02 * [5.811989327265433;
                   3.115861087870574;
                   2.342314804973926];
    d = [ 0.072064394856535;
         -0.202044348085313;
         -0.025155451778392;
          0.009925044485141];
    p_cb_p_d = alg.p_cb_w2p_cb_p_d(p_cb_ws, ...
                                   @(p, H)alg.apply_homography_p2p(p, H), ...
                                   R, ...
                                   t, ...
                                   @(x_p, y_p, a, x_o, y_o, k1, k2, p, t)[x_o-((x_o-x_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./((p.*(x_o-x_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a-(t.*(y_o-y_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a+1.0), y_o-((y_o-y_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./((p.*(x_o-x_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a-(t.*(y_o-y_p).*(k1.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2)+k2.*(1.0./a.^2.*(x_o-x_p).^2+1.0./a.^2.*(y_o-y_p).^2).^2+1.0))./a+1.0)], ...
                                   a, ...
                                   d);

    % Assert
    assert(all(all(abs(p_cb_p_d - 1.0e+02 * [0.609122450919904   4.653773087125593;
                                             0.900365806636007   4.655900470079120;
                                             1.190066027769069   4.656106608377717;
                                             1.477174741168999   4.654947429701659]) < 1e-4)));
end
